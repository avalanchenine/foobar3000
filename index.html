<html>
  <head>
    <title>Foobar3000 - the world's most advanced test server</title>
    <script src="assets/ender.js"></script>
  </head>
  <body>
    Foobar3000.com - The world's most advanced echo server!

  <div id="http">
    <h2>HTTP Echo</h2>
    <p>
      <a href="https://github.com/coolaj86/foobar3000">github.com/coolaj86/foobar3000</a> - A better README than this page.
    </p>
    <ul>
      <li>`GET /` with no parameters returns this page</li>
      <li>`[VERB] /echo?foo=bar` will echo the parameters you have given</li>
      <li>`GET /echo?headers=X-Test-Header%3A%20Hello%2FWorld` replies to the request with the additional header `X-Test-Header: Hello World`</li>
      <li>`GET /echo?body=Hello%20World%0A` replies to the request with the body `Hello World\n`</li>
      <li>`POST /meta?session=same-token&pathname=%2Ffoobar&body=Hello%20Foo%0A` creates the resource `/foobar` for the session `same-token` with whatever headers and body specified</li>
      <li>`GET /foobar?session=same-token` response with the resource just created (or an echo if there was none)</li>
      <li>`GET /checkip` returns your IP Address as `text/plain`, no html, no spaces, no need to `.trim()`</li>
      <li>Any sessions created will be deleted after 10 minutes of inactivity</li>
    </ul>
    <p>
      What's your IP? <a href="http://checkip.foobar3000.com">checkip.foobar3000.com</a> - no muss, no fuss, no markup, no `sed`, `awk`, or `.trim()` needed.
    </p>
    <p>
      <a href="http://helloworld3000.com">helloworld3000.com</a> - An alias of foobar3000.com suitable for testing CORS, XSS, etc. 
    </p>
    For your prototyping pleasure, Ender.JS is loaded on this page with the following modules:
    <ul>
      <li>jeesh</li>
      <li>reqwest</li>
      <li>jQuery</li>
      <li>ahr2</li>
    </ul>
    Open up your console and play away:
    <pre>
<code>
  var jQuery = require('jQuery')  // jQuery 1.6.3
    , $ = require('ender')        // same DOM API as jQuery
    , ajax = require('reqwest')   // same API as jQuery.ajax
    , request = require('ahr2')   // similar API to Node.JS' `request`, supports XHR2
    ;

  request('/echo').when(function (err, ahr, data) {
    console.log(arguments);
  });


  // Use foobar3000.com to create a CORS resource
  // (attached to session)
  function createCorsResource() {
    request.post('/meta', null, {
        session: "make-up-your-own-key"
      , pathname: "/hello-cors"
      , headers: [
            "Access-Control-Allow-Origin: *"
          , "Access-Control-Allow-Methods: POST, GET, PUT, DELETE, OPTIONS"
          , "Access-Control-Allow-Headers: Content-Type, Accept"
        ]
      , body: "Hello CORS World!"
    }, { headers: { "content-type": "application/json"} }).when(function (err, ahr, data) {
      console.log(arguments);
      getCorsResource();
    });
  }

  // Access the aforementioned resource from helloworld3000.com
  // (must use same session key)
  function getCorsResource() {
    request.get('http://helloworld3000.com/hello-cors?session=make-up-your-own-key').when(function (err, ahr, data) {
      console.log(arguments);
    });
  }

  createCorsResource();
</code>
    </pre>
  </div>

  <div id="tcp">
    <h2>TCP Echo</h2>

    Persistent connection:
    <pre><code>
      nc foobar3000.com 32000
    </code></pre>

    Persistent connection with keepalive:
    <pre><code>
      nc foobar3000.com 32001
    </code></pre>

    TODO: Connection that hangs up and dials back
    <pre><code>
      # Not Implemented Yet!
      echo '{ "port": "5432", "body": "Hello World" }' | nc foobar3000.com 32002
    </code></pre>
  </div>

  <div id="udp">
    <h2>UDP Echo</h2>

    Persistent (responds from bound listener):
    <pre><code>
      nc -u foobar3000.com 32000
    </code></pre>

    Redial (responds from new unbound client, probably different port):
    <pre><code>
      # you won't see a response when using netcat 
      # because the port will be different 
      nc -u foobar3000.com 32001
    </code></pre>

    TODO: Connection that dials back on a different port:
    <pre><code>
      # Not Implemented Yet!
      echo '{ "port": "5432", "body": "Hello World" }' | nc -u foobar3000.com 32002
    </code></pre>
  </div>
  </body>
</html>
